"use strict";var userId=1,userIsLogin=!1;function initEventHandlers(){$("#login").on("click",()=>{$.ajax({url:"/login",method:"get",dataType:"html",success:function(e){$(document.body).append(e),$("#authBtn").on("click",()=>{$.ajax({url:"/login",method:"post",data:{login:$("#authLogin").val(),password:$("#authPass").val(),csrfmiddlewaretoken:csrf_token},dataType:"html",success:function(e){e.is_logged||$("#message").text("Неверный логин или пароль").css("display","block")}})}),$("#resetPass").on("click",()=>{}),$("#close-auth").on("click",()=>{$("#close-auth").parent().parent().remove()})}})}),$("#register").on("click",()=>{$.ajax({url:"/register",method:"get",dataType:"html",success:function(e){$(document.body).append(e),$("#close-register").on("click",()=>{$("#close-register").parent().parent().remove()}),$("#registerBtn").on("click",()=>{$("#userPass").val()==$("#userPassConfirm").val()?$.ajax({url:"/register",method:"post",dataType:"json",data:{login:$("#userName").val(),email:$("#userLogin").val(),password:$("#userPass").val(),csrfmiddlewaretoken:csrf_token},success:function(e){e.is_reg?($.ajax({url:"/user",method:"get",dataType:"html",data:{user_id:userId,csrfmiddlewaretoken:csrf_token},success:function(e){userIsLogin=!0,checkAuth()}}),console.log(e.user)):$("#message").text(e.message).css("display","block")}}):$("#message").text("пароли не совпадают").css("display","block")})}})})}function checkAuth(){userIsLogin?($("#login").css("display","none"),$("#register").css("display","none")):($("#basket").css("display","none"),$("#personalAccount").css("display","none"))}window.onload=()=>{checkAuth(),initEventHandlers()};